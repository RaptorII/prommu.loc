$(function() {
    function t(t=false) {
        var e = n.serialize()
          , c = n.serializeArray()
          , a = !1
          , l = "";

        t && (t.preventDefault(),
        e = t.target.href.slice(t.target.href.indexOf("/vacancy?") + 9)),
        o.show(),
        urlString = "/vacancy?" + e,
        $.ajax({
            type: "GET",
            url: "/vacancy",
            data: e,
            success: function(e) {
                i.html(e);
                if(''!==redirect) {
                    document.location.href = redirect;
                    return false;
                }
                null != arSeo.url && (urlString = arSeo.url),
                null != arSeo.seo_h1 ? $("h1").text(arSeo.seo_h1) : $("h1").text("Поиск вакансий"),
                null != arSeo.meta_keywords ? $(r).html(arSeo.meta_keywords) : $(r).html(""),
                null != arSeo.meta_title ? document.title = arSeo.meta_title : document.title = "Поиск вакансий",
                window.history.pushState("object or string", "page name", urlString),
                t && $("html, body").animate({
                    scrollTop: i.offset().top - 100
                }, 700),
                o.hide()
            }
        })
    }
    function e() {
        $("*").is(".filter-cities .select2") && ($(".filter-cities .filter-content").addClass("active"),
        clearInterval(s))
    }
    var n = $("#F1Filter")
      , i = $("#content")
      , c = $(".filter-dolj .psv__checkbox-input")
      , o = $(".psv__veil")
      , a = $(".psv__salary .psv__input")
      , l = $("#psv-salary-type")
      , r = "#psv-seo-text";
    $(".templatingSelect2").select2();
    var s = setInterval(function() {
        e()
    }, 100);
    $("#vac-srch-cities").change(function() {
        t()
    }),
    $(".filter-dolj .psv__checkbox-input").change(function() {
        if ($(this).is(c[0]))
            if ($(this).is(":checked"))
                for (e = 1; e < c.length; e++)
                    $(c[e]).prop("checked", !0);
            else
                for (var e = 1; e < c.length; e++)
                    $(c[e]).prop("checked", !1);
        setTimeout(function() {
            t()
        }, 300)
    }),
    $(".filter-busy input, .filter-sex input, .filter-smart input, .filter-card input").change(function() {
        setTimeout(function() {
            t()
        }, 300)
    }),
    a.focus(function() {
        for (var t = 1, e = 0; e < a.length; e++)
            $(this).is(a[e]) && (t = e > 5 ? 4 : (e < 4 ? (e > 1 ? 2 : 1) : 3));
        for (e = 0; e < a.length; e++)
            (1 == t && 0 != e && 1 != e || 2 == t && 2 != e && 3 != e || 3 == t && 4 != e && 5 != e || 4 == t && 6 != e && 7 != e) && $(a[e]).val("");
        l.val(t)
    }),
    $(".psv__filter-btn").click(function() {
        var m = $(this).closest('.filter-label');

        if($(m).hasClass('filter-age')) {
            var arInp = $(m).find('input'),
                af = Number($(arInp[0]).val()),
                at = Number($(arInp[1]).val());

            if(af<14) {
                $(arInp[0]).val('14');
                af = 14;
            }
            if(at<af && at>0) {
                $(arInp[1]).val('14');
            }
        }
        setTimeout(function() {
            t()
        }, 300)
    }),
    $("#content").on("click", ".paging-wrapp a", function(e) {
        t(e)
    }),
    $("#content").on("click", ".psv__view-block a", function(e) {
        t(e)
    }),
    $(".more-posts").click(function() {
        $(this).closest(".filter-content").css({
            height: "788px"
        }),
        $(this).fadeOut()
    });
    $(window).on('load resize', function() {
        if ($(window).width() < '768')
            $('.psv__filter-vis').hasClass('active') ? n.show() : n.hide();
        else
            n.show()
    });
    $('.psv__filter-vis').click(function() {
        $(this).hasClass('active') ? n.fadeOut() : n.fadeIn();
        $(this).toggleClass('active')
    });
    $('.filter-salary input,.filter-age input').on('input',function(){
        var v = $(this).val().replace(/\D+/g,'');
        $(this).val(v);
    });
});

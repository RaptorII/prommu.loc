!function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var o=n(4);$(document).ready(function(){new o.PageRegApplic})},,,,function(t,e,n){"use strict";var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(){t.call(this),this.doljChoice="137",this.postSecretCustomer="12",this.cityMoskowChoice=1001,this.cityPiterChoice=1002,this.cityCounter=1,this.cropOpts={},this.cropper=null;var e=this;$("#F1profdata").submit(function(t){e.onFormSubmit(t,this)}),G_VARS.App.country=$("#CB1country").val(),$("#CB1country").change(function(t){G_VARS.App.country=$(this).val()}),$("#BtnAddCity a").click(function(t){e.onBtnAddCityClick(t,this)}),$("#EdCountry").hover(function(){G_VARS.App.showHint($(this),"Созданы блоки городов - смена страны заблокирована, для смены страны удалите все блоки с городами")},function(){G_VARS.App.closeHint()}),e.bindFiltersFn(),e.init()}return o(e,t),e.prototype.init=function(){var t=this;Hinter.bind(".hashint"),$("#BtnUploadPhoto a").click(function(e){t.onUploadPhotoClickFn(e,this)}),$(".btn-update button, .btn-save button").click(function(t){$("#Hisavest").val($(this).hasClass("savest")?"2":"1")}),$(".c-logo ._controls ._delete").click(function(t){confirm($(this).data("confirm"))?"":t.preventDefault()}),$(".c-logo").magnificPopup({delegate:"._more-photo>a",type:"image",gallery:{enabled:!0,preload:[0,2],navigateByImgClick:!0,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',tPrev:"",tNext:"",tCounter:'<span class="mfp-counter">%curr% / %total%</span>'}});var e={selectAllText:"Выбрать все/снять выделение",countSelected:"# из %",allSelected:"Выбраны все"},n=new Date;n.setDate(n.getDate()-1),$("#EdDateBirth").datepicker({format:"dd.mm.yyyy",todayBtn:"linked",calendarWeeks:!0,endDate:n,language:"ru"}),$("#CBdolj").change(function(){}).multipleSelect(CommFuncs.merge(e,{placeholder:"выберите должность...",selectAll:!1,onUncheckAll:function(e){t.onCBDoljChangeFn(e)},onClick:function(e){t.onCBDoljChangeFn(e)},onCheckAll:function(e){t.onCBDoljChangeFn(e,1)}})),$("#CBcityWork").change(function(){}).multipleSelect(CommFuncs.merge(e,{placeholder:"выберите город...",onUncheckAll:function(e){t.onCBcityWorkChangeFn(e)},onClick:function(e){t.onCBcityWorkChangeFn(e)},onCheckAll:function(e){t.onCBcityWorkChangeFn(e,1)}})),$("#CBdoljExp").change(function(){}).multipleSelect(CommFuncs.merge(e,{selectAll:!1,placeholder:"выберите должность...",onUncheckAll:function(e){t.onCBdoljExpChangeFn(e)},onClick:function(e){t.onCBdoljExpChangeFn(e)},onCheckAll:function(e){t.onCBdoljExpChangeFn(e)}})),$("#CBlangs").change(function(){}).multipleSelect(CommFuncs.merge(e,{placeholder:"выберите языки...",selectAll:!1,onUncheckAll:function(e){t.onCBlangsChangeFn(e)},onCheckAll:function(e){t.onCBlangsChangeFn(e,1)},onClick:function(e){t.onCBlangsChangeFn(e)}})),G_VARS.initPaymentsData&&t.onCBDoljChangeFn(0,0,G_VARS.initPaymentsData),t.initCities(G_VARS.userCities[0]),t.onCBlangsChangeFn(0,0,{langs:G_VARS.langsSeled}),t.onCBdoljExpChangeFn({})},e.prototype.initCities=function(t){var e=this;for(var n in t){var o=e.onBtnAddCityClick(0,0,t[n]);"1"==t[n].ismetro&&(o.find(".EdCity").attr("data-name",t[n].name),G_VARS.App.applyMetroHTML(o.find(".EdCity")[0],n))}},e.prototype.onBtnAddCityClick=function(t,e,n){var o=this,i=$("#DiCityTmplate").clone();t&&t.preventDefault();var a=n?n.name:"",r=n?n.street:"",l=n?n.addinfo:"";i.attr("id",""),i.find(".EdCity").toggleClass("nocheck").attr("name","cities["+o.cityCounter+"]").val(a),i.find(".EdStreet").attr("name","street["+o.cityCounter+"]").val(r),i.find(".EdCustomPlaceWork").attr("name","custom-place-work["+o.cityCounter+"]").val(l),i.find(".metro-select select").multipleSelect({selectAll:!1,countSelected:"# из %",allSelected:"Выбраны все",placeholder:"выберите метро...",filter:!0});var c={mon:"Понедельник",tue:"Вторник",wed:"Среда",thu:"Четверг",fri:"Пятница",tha:"Суббота",sun:"Воскресенье"},s=1;for(var p in c){var d="",f="";n&&G_VARS.userWdays&&G_VARS.userWdays[n.id]&&G_VARS.userWdays[n.id][s]&&(d=G_VARS.userWdays[n.id][s].timeb,f=G_VARS.userWdays[n.id][s].timee);var u=i.find(".day-tpl").clone();u.toggleClass("day-tpl day"),u.find(".day-title").text(c[p]),u.find(".day-chk").attr("name","week-day[".concat(o.cityCounter,"][",p,"][ch]")),u.find(".day-from").attr("name","week-day[".concat(o.cityCounter,"][",p,"][f]")).val(d),u.find(".day-to").attr("name","week-day[".concat(o.cityCounter,"][",p,"][t]")).val(f),G_VARS.App.applyCheckbox(u.find(".checkbox-box input[type=checkbox]")),i.find(".days-block").append(u),s++}i.hide(),$("#DiCitiBlocks").prepend(i),i.slideDown(400,function(){return e&&i.find(".EdCity").focus()}),o.FormFilter.bindFiltersFn(i),G_VARS.App.applyCityBox();var h=$("#CB1country")[0];return $("#EdCountry").val(h.options[h.selectedIndex].innerHTML),$("#CB1country").slideUp(200),$("#EdCountry").slideDown(200),$("#HiAddedCity").val("1"),o.cityCounter++,i},e.prototype.onCB2cityChangeFn=function(t,e){var n=this,o=$("#CB2city").multipleSelect("getSelects"),i=$("#CB2city").multipleSelect("getSelects","text");$.inArray("aa",o)>-1?$("#CityManualMultiBLock").slideDown(400).find("input").removeClass("nocheck"):$("#CityManualMultiBLock").slideUp(200).find("input").addClass("nocheck");var a=G_VARS.appcache.metro,r=$.map(o,function(t){if(G_VARS.cityWmetro[t]&&(!a||!a["city"+t]))return $.get(MainConfig.AJAX_GET_METRO,{idcity:t}).then(function(e){e=JSON.parse(e),G_VARS.appcache.metro["city"+t]=e})});$.when.apply(this,r).then(function(){n.renderMetroesHtml(o,i)})},e.prototype.renderMetroesHtml=function(t,e){var n=[];$("#DiMetroBlock .metro-select").each(function(){var e=parseInt($(this).attr("data-id"));n.push(e);var o=0;for(var i in t)if(t[i]==e){o=1;break}o||$(this).slideUp(200,function(){$(this).remove()})}),t.map(function(t,o){var i=0;for(var a in n)if(n[a]==t){i=1;break}if(!i){if(!G_VARS.cityWmetro[t])return 1;var r=$("#LMetro").clone();r.hide(),r.attr("id","CBmetro"+t),r.attr("data-id",t),r.find("b").text(function(t,n){return n.concat(e[o])});var l=r.find("select");l.attr("name","metro".concat("[",t,"][]")),G_VARS.appcache.metro["city"+t].map(function(e){var n=0;for(var o in G_VARS.userMetro)if(t==G_VARS.userMetro[o].idcity&&e.id==o){n=1;break}var i=n?"selected":"";$("<option value='".concat(e.id,"' ",i,">",e.name,"</option>")).appendTo(l)}),$("#DiMetroBlock").append(r),l.multipleSelect({selectAllText:"Выбрать все/снять выделение",countSelected:"# из %",allSelected:"Выбраны все",placeholder:"выберите метро...",filter:!0}),r.slideDown(400)}})},e.prototype.onCBDoljChangeFn=function(t,e,n){var o=this,i=n&&n.length>0,a=$("#CBdolj"),r=a.multipleSelect("getSelects"),l=a.multipleSelect("getSelects","text");r.length==a.children("option").length&&$("#CBdoljData").text("");var c=[];$(".price-level").each(function(){var t=parseInt($(this).attr("data-id"));c.push(t);var e=0;for(var n in r)if(r[n]==t){e=1;break}e||$(this).slideUp(200,function(){$(this).remove()})});var s=0;r=i?n:r;var p,d,f,u,h,m,C,v,g=function(){p=i?r[y].idpost:r[y],d=0;for(f in c)if(c[f]==p){d=1;break}if(i&&(d=0),!d){u=$($("#TPL1Payment").text()),u.attr("data-id",p),u.hide(),h=u.find("label");var t=i?r[y].val:l[y];h.children("b").text(function(e,n){return"".concat(t," ",n)}),m=u.find(".js-name"),m.attr("name","post["+p+"]["+m.attr("name")+"]"),p!=o.doljChoice&&m.parent().hide(),C=u.find(".js-payment"),C.attr("name","post["+p+"]["+C.attr("name")+"]"),v=u.find("select"),v.attr("name","post["+p+"]["+v.attr("name")+"]"),$("#DiPayment").append(u),u.slideDown(400),i&&(C.val(r[y].pay),m.val(r[y].mech),$.each(v.children(),function(){var t=$(this);t.attr("value")==r[y].pt&&t.prop("selected",!0)}))}};for(var y in r)g();s?$(".custom-dolj").slideDown(400):$(".custom-dolj").slideUp(200)},e.prototype.onCBdoljExpChangeFn=function(t,e){var n=this,o=$("#CBdoljExp").multipleSelect("getSelects"),i=$("#CBdoljExp").multipleSelect("getSelects","text");if(e){var a=$("#CBlangs"),r=[];for(var l in e.langs)r.push(l);a.multipleSelect("setSelects",r)}var r=[];$(".exp-lvl").each(function(){var t=parseInt($(this).attr("data-id"));r.push(t);var e=0;for(var n in o)if(o[n]==t){e=1;break}e||$(this).slideUp(200,function(){$(this).remove()})});for(var l in o){var c=0;for(var s in r)if(r[s]==o[l]){c=1;break}if(!c){var p=G_VARS.postsSelected,d=$($("#TPL2Exp").text());d.attr("data-id",o[l]),d.hide(),d.find("b").text(function(t,e){return e+" ("+i[l]+"):"});var f=d.find(".name input");f.attr("name","exp["+o[l]+"][name]"),o[l]==n.doljChoice&&p.forEach(function(t){o[l]==t.idpost&&f.val(t.mech)}),o[l]!=n.doljChoice&&f.parent().hide();var u=d.find("select");u.attr("name","exp["+o[l]+"][level]"),u.find("option").each(function(t){var e=$(this);for(var n in p){var i=p[n].idpost==o[l]&&e.attr("value")==p[n].id_attr;i&&e.prop("selected",!0)}}),$("#DiExpLevels").append(d),d.slideDown(400)}}},e.prototype.onCBcityWorkChangeFn=function(t,e){var n=this,o=$("#CBcityWork").multipleSelect("getSelects"),i=($("#CBcityWork").multipleSelect("getSelects","text"),0),a=0;for(var r in o)n.cityMoskowChoice==o[r]?i=1:n.cityPiterChoice==o[r]&&(a=1);i?$("#LMetroMosk").slideDown(400):$("#LMetroMosk").slideUp(200),a?$("#LMetroPiter").slideDown(400):$("#LMetroPiter").slideUp(200)},e.prototype.onCBlangsChangeFn=function(t,e,n){var o=$("#CBlangs");if(n){var i=[];for(var a in n.langs)i.push(a);o.multipleSelect("setSelects",i)}var r=o.multipleSelect("getSelects"),l=o.multipleSelect("getSelects","text"),i=[];$(".lang-level").each(function(){var t=parseInt($(this).attr("data-id"));i.push(t);var e=0;for(var n in r)if(r[n]==t){e=1;break}e||$(this).slideUp(200,function(){$(this).remove()})});for(var a in r){var c=0;for(var s in i)if(i[s]==r[a]){c=1;break}if(!c){var p=$(".langs-level-tmlp").clone();p.attr("data-id",r[a]).toggleClass("langs-level-tmlp lang-level"),p.hide();var d=p.find("label"),f=d.attr("for")+r[a];d.attr("for",f),d.find("b").text(d.find("b").text()+" ("+l[a]+"):");var u=p.find("select");u.attr("id",f),u.attr("name",u.attr("name")+"["+r[a]+"]");var h=G_VARS.langsLvls;for(var m in h){var C=n&&n.langs[r[a]]==h[m][0]?"selected":"";$("<option value='".concat(h[m][0],"' ",C,">",h[m][1],"</option>")).appendTo(u)}$("#DiLangsLevels").append(p),p.slideDown(400)}}},e.prototype.debug=function(){$("#EdName").val("test"),$("#EdSurname").val("test"),$("#EdDateBirth").val("test"),$("#CB2city").val("1"),$("#EdEmail").val("aazz@aa.com")},e.prototype.onUploadPhotoClickFn=function(t,e){var n=this;t.preventDefault();var o=$(".F2photo").clone();o.toggleClass("tmpl F2photo").attr("id","F2photo"),o.find(".btn-startupload a").click(function(t){t.preventDefault(),$(this).closest("form").find(".message").text(""),$(this).closest("form").find(".inp-photo").trigger("click")}),o.find(".inp-photo").change(function(){n.onUploadFileSetFn(this)}),o.find(".btn-crop").click(function(t){n.onSendCroppedFn(t,this)}),$("body").stop().animate({scrollTop:"0px"},0),ModalWindow.open({content:o,action:{active:0},bgIsCloseBtn:0,position:"absolute",context:"body",afterOpen:function(){$("#DiSiteWrapp").css({overflow:"hidden"})},afterClose:function(){$("#DiSiteWrapp").css({overflow:""})}})},e.prototype.onUploadFileSetFn=function(t){var e,n=this,o=$(t),i=t.files[0],a=1,r=o.closest("form"),l=r.find(".message");if(i)if("image/jpeg"!=i.type&&"image/png"!=i.type?(a=0,e=l.data("type")):i.size>5242880&&(a=0,e=l.data("size")),a){r.find(".loading-ico").fadeIn(400);var c=new FormData(r[0]);$.ajax({url:MainConfig.AJAX_POST_POSTLOGOFILE,type:"POST",success:function(t){if(t=JSON.parse(t),t.error)r.find(".message").text(t.message),t.ret&&console.log("ret",t.ret);else{var e=r.find(".img-crop-tpl").clone();e.toggleClass("img-crop img-crop-tpl tmpl");var o=r.find(".img-block ._img-wrapp");o.empty(),o.prepend(e),e.css({display:"none"}),e.attr("src",t.file).load(function(){var t=this.height>this.width?this.height:0;$("body").stop().animate({scrollTop:"0px"},0),r.find(".img-crop-block").slideDown(400,function(){ModalWindow.hide(),r.find(".btn-startupload").fadeOut(200),r.find(".info").fadeOut(200),setTimeout(function(){e.show(),t>700&&e.css({height:"700px"}),ModalWindow.moveCenter({fade:!0}),ModalWindow.show(),n.cropper&&n.cropper.destroy(),n.cropper=new Cropper(e[0],{aspectRatio:1,viewMode:1,minCropBoxWidth:100,minCropBoxHeight:100,zoomable:!1,rotatable:!1,background:!1,guides:!1,highlight:!1,crop:function(t){n.cropOpts=t.detail}})},500)})})}},error:function(){r.find(".message").text("Ошибка загрузки файла, обновите страницу и попробуйте еще раз")},data:c,cache:!1,contentType:!1,processData:!1},"json").always(function(){r.find(".loading-ico").fadeOut(200)})}else l.text(e)},e.prototype.onSendCroppedFn=function(t,e){var n=this,o=$(e),i=o.closest("form");t.preventDefault(),i.find(".loading-ico").fadeIn(400),$.post(MainConfig.AJAX_POST_CROPLOGO,n.cropOpts,function(t){t=JSON.parse(t),location.reload()}).always(function(){i.find(".loading-ico").fadeOut(200)})},e}(Page);e.PageRegApplic=i}]);